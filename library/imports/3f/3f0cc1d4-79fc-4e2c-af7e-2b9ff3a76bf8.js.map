{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\hero.js"],"names":["cc","Class","extends","Component","properties","blowupani","default","type","Prefab","tooltip","gameOverClip","AudioClip","main","require","bulletGroup","onLoad","eState","D","commonInfo","gameState","none","director","getCollisionManager","enabled","onDrag","node","on","dragMove","offDrag","off","event","locationv","getLocation","location","parent","convertToNodeSpaceAR","minX","width","maxX","minY","height","maxY","x","y","setPosition","onCollisionEnter","other","self","group","name","changeBullet","getUfoBomb","po","getPosition","blowup","instantiate","addChild","animation","getComponent","Animation","onFinished","audioEngine","playEffect","destroy","gameOver"],"mappings":"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","file":"hero.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties:()=> ({\n        blowupani: {\n            default: null,\n            type:cc.Prefab,\n            tooltip: '爆炸动画',\n        },\n        \n        gameOverClip: cc.AudioClip,\n        main: {\n            default: null,\n            type: require('main'),\n        },\n        bulletGroup: {\n            default: null,\n            type: require('bulletGroup'),\n        }\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        this.eState = D.commonInfo.gameState.none;\n        cc.director.getCollisionManager().enabled=true;\n        this.onDrag();\n        \n    },\n\n    //添加拖动监听\n    onDrag: function(){\n        this.node.on('touchmove', this.dragMove, this);\n    },\n    //去掉拖动监听\n    offDrag: function(){ \n         this.node.off('touchmove', this.dragMove, this);\n    },\n    //拖动\n    dragMove: function(event){ \n        var locationv = event.getLocation();\n        var location = this.node.parent.convertToNodeSpaceAR(locationv);\n        //飞机不移出屏幕 \n        var minX = -this.node.parent.width/2+this.node.width/2;\n        var maxX = -minX;\n        var minY = -this.node.parent.height/2+this.node.height/2;\n        var maxY = -minY;\n        if (location.x< minX){\n            location.x = minX;\n        }\n        if (location.x>maxX){\n            location.x = maxX;\n        }\n        if (location.y< minY){\n            location.y = minY;\n        }\n        if (location.y> maxY){\n            location.y = maxY;\n        }\n        this.node.setPosition(location);\n    },\n    //碰撞监测\n    onCollisionEnter: function(other,self) {\n        if (other.node.group == 'ufo'){\n            if (other.node.name == 'ufoBullet'){\n                this.bulletGroup.changeBullet(other.node.name);\n            } else if (other.node.name == 'ufoBomb'){\n                this.main.getUfoBomb();\n            }\n        } else if (other.node.group == 'enemy'){\n            //播放动画\n            var po = this.node.getPosition();\n            var blowup = cc.instantiate(this.blowupani);\n            this.node.parent.addChild(blowup);\n            blowup.setPosition(po);\n            var animation = blowup.getComponent(cc.Animation);\n            animation.on('finished',  this.onFinished, blowup);\n            //播放音效\n            cc.audioEngine.playEffect(this.gameOverClip, false);\n            //清除节点\n            this.node.destroy();\n            //更新分数 \n            this.main.gameOver();   \n        } else {\n            return false;\n        }\n        \n    },\n    \n    onFinished: function(event) { //动画结束后\n        this.destroy();\n        //cc.director.pause();\n        \n    },\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}