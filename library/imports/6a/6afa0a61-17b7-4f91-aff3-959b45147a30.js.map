{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\main.js"],"names":["cc","Class","extends","Component","properties","pause","Button","btnSprite","default","type","SpriteFrame","tooltip","bomb","Node","gameMusic","AudioSource","useBombClip","AudioClip","enemyGroup","require","hero","ufoGroup","bulletGroup","scoreDisplay","Label","bombNoDisplay","onLoad","score","bombNo","string","eState","D","commonInfo","gameState","start","startAction","on","bombOnclick","play","bombNoLabel","getChildByName","getComponent","parseInt","removeEnemy","audioEngine","playEffect","console","log","pauseClick","resumeAction","pauseAction","onDrag","resume","normalSprite","pressedSprite","hoverSprite","offDrag","gainScore","scoreno","toString","getScore","updateScore","currentScore","scoreData","common","timeFmt","Date","preData","sys","localStorage","getItem","preTopScore","setItem","unshift","JSON","parse","Array","stringify","node","removeAllChildren","getUfoBomb","gameOver","director","loadScene"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\ncc.Class({\n    \n    extends: cc.Component,\n\n    properties:()=>({\n        pause: cc.Button,\n        btnSprite: {\n            default: [],\n            type: cc.SpriteFrame,\n            tooltip:'暂停按钮不同状态的图片',\n        },\n        bomb: cc.Node,\n        gameMusic: {\n            default: null,\n            type: cc.AudioSource\n        },\n        useBombClip: cc.AudioClip,\n        enemyGroup: {\n            default: null,\n            type: require('enemyGroup'),\n        },\n        hero: {\n            default: null,\n            type: require('hero'),\n        }, \n        ufoGroup: {\n            default: null,\n            type: require('ufoGroup'),\n        },\n        bulletGroup: {\n            default: null,\n            type: require('bulletGroup'),\n        },\n        scoreDisplay:cc.Label,\n        bombNoDisplay:cc.Label,\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        \n        this.score = 0;\n        this.bombNo = 0;\n        this.scoreDisplay.string = this.score;\n        this.bombNoDisplay.string = this.bombNo;\n        this.eState = D.commonInfo.gameState.start;\n\n        this.enemyGroup.startAction();\n        this.bulletGroup.startAction();\n        this.ufoGroup.startAction();\n        this.bomb.on('touchstart',this.bombOnclick,this);\n        this.gameMusic.play();\n    },\n    \n    bombOnclick: function(){\n        var bombNoLabel = this.bomb.getChildByName('bombNo').getComponent(cc.Label);\n        var bombNo = parseInt(bombNoLabel.string);\n        \n        if (bombNo>0){\n            bombNoLabel.string = bombNo-1;\n            this.removeEnemy();\n            cc.audioEngine.playEffect(this.useBombClip, false);\n        } else {\n            console.log('没有子弹');\n        }\n    },\n    // called every frame, uncomment this function to activate update callback\n    //update: function (dt) {\n        \n    //},\n    \n    //暂停按钮点击事件  \n    pauseClick: function () {//暂停 继续\n    \n        if(this.eState == D.commonInfo.gameState.pause){\n            this.resumeAction();\n            this.eState = D.commonInfo.gameState.start;\n        } else if(this.eState == D.commonInfo.gameState.start) {\n            this.pauseAction();\n            this.eState = D.commonInfo.gameState.pause;\n        }\n    },\n    //游戏继续\n    resumeAction: function(){\n        this.enemyGroup.resumeAction();\n        this.bulletGroup.resumeAction();\n        this.ufoGroup.resumeAction();\n        this.hero.onDrag();\n        this.gameMusic.resume();\n        this.pause.normalSprite = this.btnSprite[0];\n        this.pause.pressedSprite = this.btnSprite[1];\n        this.pause.hoverSprite = this.btnSprite[1];\n    },\n    //游戏暂停\n    pauseAction: function(){\n        this.enemyGroup.pauseAction();\n            this.bulletGroup.pauseAction();\n            this.hero.offDrag();\n            this.gameMusic.pause();\n            this.ufoGroup.pauseAction();\n            this.pause.normalSprite = this.btnSprite[2];\n            this.pause.pressedSprite = this.btnSprite[3];\n            this.pause.hoverSprite = this.btnSprite[3];\n            \n    },\n    //增加分数\n    gainScore: function (scoreno) {\n        this.score += scoreno;\n        //更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = this.score.toString();\n    },\n    //get分数\n    getScore: function(){\n        return parseInt(this.scoreDisplay.string);\n    },\n    //分数写到本地（ 当前分 最高分 历史记录）\n    updateScore: function() {\n        var currentScore = this.scoreDisplay.string;\n        var scoreData = {\n            'score':currentScore,\n            'time': D.common.timeFmt(new Date(),'yyyy-MM-dd hh:mm:ss'),\n        };\n        var preData = cc.sys.localStorage.getItem('score');\n        var preTopScore = cc.sys.localStorage.getItem('topScore');\n        if (!preTopScore || parseInt(preTopScore) < parseInt(currentScore)){\n           cc.sys.localStorage.setItem('topScore', currentScore); \n        }\n        if(!preData){\n            preData = [];\n            preData.unshift(scoreData);\n            \n        } else {\n            preData = JSON.parse(preData);\n\t    if (!(preData instanceof Array)){\n                preData = [];    \n            }\n            preData.unshift(scoreData);\n        }\n        cc.sys.localStorage.setItem('currentScore', currentScore);\n        cc.sys.localStorage.setItem('score', JSON.stringify(preData));\n    },\n    //炸弹清除敌机\n    removeEnemy: function() {\n        this.enemyGroup.node.removeAllChildren();\n    },\n    //接到炸弹\n    getUfoBomb: function() { \n        if (parseInt(this.bombNoDisplay.string)<3){//多于三个炸弹就不累加\n            this.bombNoDisplay.string += 1;\n        }   \n    },\n    //游戏结束\n    gameOver: function(){ \n        this.pauseAction();\n        this.updateScore();\n        cc.director.loadScene('end');\n    },\n});\n"]}