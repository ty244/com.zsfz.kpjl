{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\enemy.js"],"names":["cc","Class","extends","Component","properties","xMinSpeed","default","type","Integer","tooltip","xMaxSpeed","yMinSpeed","yMaxSpeed","initHP","initSpriteFrame","SpriteFrame","score","enemyDownClip","AudioClip","onLoad","console","log","director","getCollisionManager","enabled","xSpeed","Math","random","ySpeed","random0To1","enemyGroup","node","parent","getComponent","init","group","hP","nSprite","Sprite","spriteFrame","update","dt","eState","D","commonInfo","gameState","start","scores","getScore","y","x","height","enemyDied","onCollisionEnter","other","self","bullet","hpDrop","anim","Animation","animName","name","play","on","onFinished","audioEngine","playEffect","event"],"mappings":"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","file":"enemy.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        xMinSpeed: {\n            default:0,\n            type:cc.Integer,\n            tooltip: 'x轴最小速度',\n        },\n        xMaxSpeed: {\n            default:0,\n            type:cc.Integer,\n            tooltip: 'x轴最大速度',\n        },\n        yMinSpeed: {\n            default:0,\n            type:cc.Integer,\n            tooltip: 'y轴最小速度',\n        },\n        yMaxSpeed: { \n            default:0,\n            type:cc.Integer,\n            tooltip: 'y轴最大速度',\n        },\n        initHP: {\n            default:0,\n            type:cc.Integer,\n            tooltip: '初始生命值',\n        }, \n        initSpriteFrame:{\n            default: null,\n            type: cc.SpriteFrame,\n            tooltip: '初始化的图像'\n        }, \n        score: {\n            default:0,\n            type:cc.Integer,\n            tooltip: '死后获得的分数'\n\n        },\n        enemyDownClip: cc.AudioClip\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        console.log('enemy onload');\n        cc.director.getCollisionManager().enabled=true;\n        \n        this.xSpeed = Math.random()*(this.xMaxSpeed-this.xMinSpeed) + this.xMinSpeed;\n        this.ySpeed = cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed) + this.yMinSpeed;\n        this.enemyGroup = this.node.parent.getComponent('enemyGroup');\n        \n    },\n    init: function(){\n        \n        if (this.node.group != 'enemy'){\n            this.node.group = 'enemy';\n        }\n        if (this.hP != this.initHP){\n            this.hP = this.initHP;\n        }\n        var nSprite = this.node.getComponent(cc.Sprite);\n        if (nSprite.spriteFrame != this.initSpriteFrame){\n            nSprite.spriteFrame = this.initSpriteFrame;\n        }\n        \n    },\n    \n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (this.enemyGroup.eState != D.commonInfo.gameState.start){\n            return ;\n        }\n        //分数不同 速度不同\n        var scores = this.enemyGroup.getScore();\n        if(scores<=50000){\n            this.node.y += dt*this.ySpeed;\n        }\n        else if(scores>50000&&scores<=100000){\n            this.node.y += dt*this.ySpeed-0.5;\n        }\n        else if(scores>100000&&scores<=150000){\n            this.node.y += dt*this.ySpeed-1;\n        }\n        else if(scores>150000&&scores<=200000){\n            this.node.y += dt*this.ySpeed-1.5;\n        }\n        else if(scores>200000&&scores<=300000){\n            this.node.y += dt*this.ySpeed-2;\n        } else{\n            this.node.y += dt*this.ySpeed-3;\n        }\n        this.node.x += dt*this.xSpeed;\n        //出屏幕后 回收节点\n        if (this.node.y < -this.node.parent.height/2){\n            this.enemyGroup.enemyDied(this.node,0);\n        }\n    },\n    //碰撞检测\n    onCollisionEnter: function(other,self){\n        if (other.node.group != 'bullet'){\n            return ;\n        }\n        var bullet = other.node.getComponent('bullet');\n        \n        if (this.hP>0){//防止再次碰撞\n            this.hP -= bullet.hpDrop;\n        } else {\n            return ;\n        }\n        if (this.hP <= 0){\n            this.node.group = 'default'; //不让动画在执行碰撞\n            //播放动画\n            var anim = this.getComponent(cc.Animation);\n            var animName = self.node.name + 'ani';\n            anim.play(animName);\n            anim.on('finished',  this.onFinished, this);\n            //播放音效\n            cc.audioEngine.playEffect(this.enemyDownClip, false);  \n        }\n    },\n    //动画结束后 动画节点回收\n    onFinished: function(event) { \n        this.enemyGroup.enemyDied(this.node, this.score);\n    },\n    \n});\n"]}